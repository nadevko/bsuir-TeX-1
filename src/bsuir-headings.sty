\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{bsuir-headings}[2025/12/28 Headings configuration]

% --- Настройка глубины ---
\setcounter{secnumdepth}{3} % нумеруем до subsubsection
\setcounter{tocdepth}{3}

% --- Шрифты заголовков ---
% Все заголовки: 14pt (наследуется от основного), жирные
\setkomafont{disposition}{\normalfont\bfseries}
% Главы: ПРОПИСНЫМИ (Checklist §2.3)
\setkomafont{chapter}{\normalfont\bfseries\MakeUppercase}
\setkomafont{section}{\normalfont\bfseries}
\setkomafont{subsection}{\normalfont\bfseries}
\setkomafont{subsubsection}{\normalfont\bfseries}

% --- Настройка ГЛАВ (Chapter) ---
% Checklist §2.4 line 81: разделы начинаются с новой страницы
% Checklist §2.4 line 74: между названием раздела и текстом - одна пробельная строка
\RedeclareSectionCommand[
  beforeskip=-1sp, % Отрицательный для принудительного page break
  afterskip=\baselineskip, % Одна пробельная строка после заголовка
  font={} % Шрифт задан выше через setkomafont
]{chapter}

% Checklist §2.3 line 67: Продолжение заголовка с левого края, не с абзацного отступа
% Номер раздела с абзацным отступом, но продолжение заголовка с левого края
\renewcommand*{\chapterformat}{%
  \hspace{1.25cm}\thechapter\enskip%
}

% Переопределяем формат заголовка главы для правильного выравнивания продолжения
\renewcommand*{\chapterlinesformat}[3]{%
  \makebox[0pt][l]{\hspace{1.25cm}#2}% Номер с отступом
  #3% Заголовок начинается с левого края
}

% --- Настройка РАЗДЕЛОВ (Section, Subsection...) ---
% Checklist §2.4: между заголовками раздела и подраздела пробельная строка
% Checklist §2.4: между заголовком подраздела и абзацем текста пробельная строка
\RedeclareSectionCommand[
  beforeskip=\baselineskip, % Пробельная строка перед заголовком
  afterskip=\baselineskip,  % Пробельная строка после заголовка
  runin=false
]{section}

\RedeclareSectionCommand[
  beforeskip=\baselineskip,
  afterskip=\baselineskip,
  runin=false
]{subsection}

\RedeclareSectionCommand[
  beforeskip=0pt, % Checklist §2.4 line 77: между заголовками пункта и подпункта отступа нет
  afterskip=0pt,  % Между подпунктом и абзацем отступа нет
  runin=false
]{subsubsection}

% --- Форматы номеров ---
% Checklist §2.2: номер жирный, без точки в конце
% Checklist §2.2: номер с абзацным отступом (1.25cm)
\renewcommand*{\sectionformat}{%
  \hspace{1.25cm}\bfseries\thesection\enskip%
}
\renewcommand*{\subsectionformat}{%
  \hspace{1.25cm}\bfseries\thesubsection\enskip%
}
\renewcommand*{\subsubsectionformat}{%
  \hspace{1.25cm}\bfseries\thesubsubsection\enskip%
}

% --- Содержание (TOC) ---
\RequirePackage{tocbasic}
% Checklist §2.5: Слово "СОДЕРЖАНИЕ" по центру, полужирный, 14-16 пунктов
\RenewDocumentCommand{\contentsname}{}{СОДЕРЖАНИЕ}

% Настройка TOC: заголовок по центру, полужирный
\let\originaltableofcontents\tableofcontents
\RenewDocumentCommand{\tableofcontents}{}{
  \begingroup
  \let\clearpage\relax
  \centering
  \bfseries
  \originaltableofcontents
  \endgroup
}

% Checklist §2.5: между словом СОДЕРЖАНИЕ и самим содержанием - пробельная строка
% Это обрабатывается автоматически через KOMA-Script

% --- Ненумерованные разделы (Введение, Заключение) ---
% Checklist §1.3: названия ненумерованных разделов по центру без абзацного отступа
\NewDocumentCommand{\anonsection}{m}{
  \clearpage
  \phantomsection
  \addcontentsline{toc}{chapter}{#1}
  \begin{center}
    \bfseries\MakeUppercase{#1}
  \end{center}
  \par\nobreak\vspace{\baselineskip}
  \@afterheading
}

% --- Колонтитулы (Номер страницы) ---
% Checklist §2.6: страницы нумеруют арабскими цифрами в правом нижнем углу
\RequirePackage[automark]{scrlayer-scrpage}
\clearpairofpagestyles
% Номер страницы внизу справа
\ofoot*{\thepage}
% Checklist §1.1: номер страницы в 10мм от нижнего края (обрабатывается через footskip в geometry)

\endinput
