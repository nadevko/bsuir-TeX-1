\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{bsuir-appendix}[2025/12/28 Appendix]

\RequirePackage{appendix}

% Checklist §7.2: Приложения обозначают заглавными буквами русского алфавита, начиная с А
% Исключаются буквы Ё, З, Й, О, Ч, Ъ, Ы, Ь
% Это обрабатывается через \Asbuk из babel

% Checklist §7.3: Каждое приложение начинают с новой страницы
% Вверху по центру страницы пишут слово ПРИЛОЖЕНИЕ прописными буквами и его буквенное обозначение
% Ниже в круглых скобках строчными буквами указывают слово «обязательное», «рекомендуемое» или «справочное»
% Еще ниже по центру размещают заголовок, который записывают с прописной буквы

% Переопределяем команду \appendix
\let\bsuir@old@appendix\appendix
\renewcommand{\appendix}{%
  \bsuir@old@appendix
  \setcounter{chapter}{0}
  \setcounter{section}{0}
  \gdef\@chapapp{ПРИЛОЖЕНИЕ}
  \gdef\thechapter{\Asbuk{chapter}} % Русские буквы А, Б, В...
  
  % Переопределяем формат заголовка приложения для центрирования
  \RedeclareSectionCommand[
    beforeskip=-1sp, % Принудительный page break
    afterskip=\baselineskip,
    font={}
  ]{chapter}
  
  % Формат: "ПРИЛОЖЕНИЕ А" по центру
  \renewcommand*{\chapterformat}{}
  \def\chapterlinesformat##1##2##3{%
    \begin{center}
      \bfseries\MakeUppercase{\@chapapp}~\thechapter
    \end{center}
    \vspace{\baselineskip}
    % Здесь можно добавить строку "(обязательное)" если нужно
    % Пока оставляем без неё, так как это зависит от типа приложения
    \begin{center}
      ##3% Заголовок приложения
    \end{center}
  }
}

% Команда для указания типа приложения (обязательное/рекомендуемое/справочное)
\NewDocumentCommand{\appendixnote}{m}{
  \begin{center}
    (#1)
  \end{center}
}

\endinput
